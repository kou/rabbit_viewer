#!/usr/bin/env ruby

require "rabbit/command/rabbit"
require "fileutils"

tempfile= "/tmp/rabbit-viewer.#{$$}.tmp.rab"

begin
  File.open(tempfile, "a") do |tempfile|
    title = "= rabbit-viewer"
    tempfile.puts(title)

    Dir.glob(ARGV[0]) do |viewfile|
      page = <<-EOT
= #{File.basename(viewfile)}
  # image
  # src = #{viewfile}
      EOT
      tempfile.puts(page)
    end
  end

  Rabbit::Command::Rabbit.run(tempfile)
ensure
  FileUtils.rm(tempfile)
end
